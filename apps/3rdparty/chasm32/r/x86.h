// File author is √çtalo Lima Marconato Matias
//
// Created on December 03 of 2018, at 19:52 BRT
// Last edited on January 06 of 2019, at 19:26 BRT

#ifndef __X86_H__
#define __X86_H__

#define TOK_TYPE_MUL (TOK_TYPE_COLON + 0x01)
#define TOK_TYPE_OBRAC (TOK_TYPE_COLON + 0x02)
#define TOK_TYPE_CBRAC (TOK_TYPE_COLON + 0x03)
#define TOK_TYPE_REGISTER (TOK_TYPE_COLON + 0x04)

#define NODE_TYPE_REP (NODE_TYPE_LABEL + 0x01)
#define NODE_TYPE_REPE (NODE_TYPE_LABEL + 0x02)
#define NODE_TYPE_LOCK (NODE_TYPE_LABEL + 0x03)
#define NODE_TYPE_REPNE (NODE_TYPE_LABEL + 0x04)
#define NODE_TYPE_ADDRESS (NODE_TYPE_LABEL + 0x05)
#define NODE_TYPE_POINTER (NODE_TYPE_LABEL + 0x06)
#define NODE_TYPE_REGISTER (NODE_TYPE_LABEL + 0x07)
#define NODE_TYPE_INSTRUCTION (NODE_TYPE_LABEL + 0x08)

#define INSTR_TYPE_NONE 0x00
#define INSTR_TYPE_LEFT 0x02
#define INSTR_TYPE_RELB 0x04
#define INSTR_TYPE_RELW 0x08
#define INSTR_TYPE_RELD 0x10
#define INSTR_TYPE_BYTE 0x20
#define INSTR_TYPE_WORD 0x40
#define INSTR_TYPE_DWORD 0x80
#define INSTR_TYPE_MODRM 0x100
#define INSTR_TYPE_OPREGB 0x200
#define INSTR_TYPE_OPREGW 0x400
#define INSTR_TYPE_OPREGD 0x800
#define INSTR_TYPE_POINTER 0x1000

#define INSTR_ARG_NONE 0x00
#define INSTR_ARG_IMMB 0x02
#define INSTR_ARG_IMMW 0x04
#define INSTR_ARG_IMMD 0x08
#define INSTR_ARG_VONE 0x10
#define INSTR_ARG_SREG 0x20
#define INSTR_ARG_CREG 0x40
#define INSTR_ARG_DREG 0x80
#define INSTR_ARG_ST0 0x100
#define INSTR_ARG_TREG 0x200
#define INSTR_ARG_XREG 0x400
#define INSTR_ARG_XMM0 0x800
#define INSTR_ARG_GREGB 0x1000
#define INSTR_ARG_GREGW 0x2000
#define INSTR_ARG_GREGD 0x4000
#define INSTR_ARG_STREG 0x8000
#define INSTR_ARG_DESTB 0x10000
#define INSTR_ARG_DESTW 0x20000
#define INSTR_ARG_DESTD 0x40000
#define INSTR_ARG_MOFFS 0x80000
#define INSTR_ARG_ACCUMB 0x100000
#define INSTR_ARG_ACCUMW 0x200000
#define INSTR_ARG_ACCUMD 0x400000
#define INSTR_ARG_COUNTB 0x800000
#define INSTR_ARG_COUNTW 0x1000000
#define INSTR_ARG_COUNTD 0x2000000
#define INSTR_ARG_POINTER 0x4000000
#define INSTR_ARG_MODRM_REG 0x8000000
#define INSTR_ARG_MODRM_ADDR 0x10000000
#define INSTR_ARG_MODRM_DISP 0x20000000
#define INSTR_ARG_MODRM_MULT 0x40000000
#define INSTR_ARG_MMODRM (INSTR_ARG_MODRM_REG | INSTR_ARG_MODRM_ADDR | INSTR_ARG_MODRM_DISP | INSTR_ARG_MODRM_MULT)
#define INSTR_ARG_XMODRM (INSTR_ARG_XREG | INSTR_ARG_MODRM_REG | INSTR_ARG_MODRM_ADDR | INSTR_ARG_MODRM_DISP | INSTR_ARG_MODRM_MULT)
#define INSTR_ARG_MODRM (INSTR_ARG_GREGB | INSTR_ARG_GREGW | INSTR_ARG_GREGD | INSTR_ARG_MODRM_REG | INSTR_ARG_MODRM_ADDR | INSTR_ARG_MODRM_DISP | INSTR_ARG_MODRM_MULT)

typedef struct {
	node_t base;
	int have_disp;
	int have_mul;
	int32_t disp;
	uint32_t mul;
} address_node_t;

typedef struct {
	node_t base;
	char *name;
} register_node_t, instruction_node_t;

#endif		// __X86_H__
